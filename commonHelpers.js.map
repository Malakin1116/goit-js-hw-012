{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '43967631-6112ded5daea5d7f1facaa737';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchPhotosByQuery = async (q = 'pug', page = 1, per_page = 15) => {\n    const searchParams = new URLSearchParams({\n        key: API_KEY,\n        q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n    });\n\n    try {\n        const response = await axios.get(`${BASE_URL}?${searchParams}`);\n        return response.data;\n    } catch (error) {\n        throw new Error(error.response ? error.response.statusText : error.message);\n    }\n};\n","export const createMarkupItem = images => {\n  return images\n    .map(image => {\n      const {\n        webformatURL = '',\n        largeImageURL = '',\n        tags = '',\n        likes = 0,\n        views = 0,\n        comments = 0,\n        downloads = 0,\n      } = image;\n\n      return `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"small-content\">\n            <span class=\"text-body-likes\"><strong>Likes:</strong> ${likes}</span>\n            <span class=\"text-body-views\"><strong>Views:</strong> ${views}</span>\n            <span class=\"text-body-comments\"><strong>Comments:</strong> ${comments}</span>\n            <span class=\"text-body-downloads\"><strong>Downloads:</strong> ${downloads}</span>\n          </div>\n        </li>\n      `;\n    })\n    .join('');\n};\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchPhotosByQuery } from \"./js/pixabay-api\";\nimport { createMarkupItem } from \"./js/render-functions\";\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormEl = document.querySelector('.js-search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loaderEl = document.querySelector('#loader');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nlet searchQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\n\nfunction onSearchFormSubmit(event) {\n    event.preventDefault();\n\n    searchQuery = event.target.elements.searchKeyword.value.trim();\n    currentPage = 1;\n    totalHits = 0;\n\n    if (searchQuery === '') {\n        galleryEl.innerHTML = '';\n        event.target.reset();\n        iziToast.error({\n            title: 'Error',\n            message: 'Illegal operation',\n            position: 'topRight',\n            timeout: 2000,\n        });\n        return;\n    }\n\n    galleryEl.innerHTML = '';\n    loaderEl.classList.remove('hidden');\n    loadMoreBtn.classList.add('hidden');\n\n    fetchPhotosByQuery(searchQuery, currentPage)\n        .then(imagesData => {\n            totalHits = imagesData.totalHits;\n            if (totalHits === 0) {\n                iziToast.show({\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                    position: 'topRight',\n                    timeout: 2000,\n                    color: 'red',\n                });\n            } else {\n                galleryEl.innerHTML = createMarkupItem(imagesData.hits);\n                lightbox.refresh();\n                if (imagesData.hits.length < totalHits) {\n                    loadMoreBtn.classList.remove('hidden');\n                }\n            }\n        })\n        .catch(error => console.log(error))\n        .finally(() => {\n            event.target.reset();\n            loaderEl.classList.add('hidden');\n        });\n}\n\nfunction onLoadMoreBtnClick() {\n    currentPage += 1;\n    loaderEl.classList.remove('hidden');\n\n    fetchPhotosByQuery(searchQuery, currentPage)\n        .then(imagesData => {\n            galleryEl.insertAdjacentHTML('beforeend', createMarkupItem(imagesData.hits));\n            lightbox.refresh();\n\n            if (galleryEl.children.length >= totalHits) {\n                loadMoreBtn.classList.add('hidden');\n                iziToast.show({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    position: 'topRight',\n                    timeout: 2000,\n                    color: 'blue',\n                });\n            }\n        })\n        .catch(error => console.log(error))\n        .finally(() => {\n            loaderEl.classList.add('hidden');\n        });\n}\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n"],"names":["API_KEY","BASE_URL","fetchPhotosByQuery","q","page","per_page","searchParams","axios","error","createMarkupItem","images","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryEl","searchFormEl","loadMoreBtn","loaderEl","lightbox","SimpleLightbox","searchQuery","currentPage","totalHits","onSearchFormSubmit","event","iziToast","imagesData","onLoadMoreBtnClick"],"mappings":"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"}